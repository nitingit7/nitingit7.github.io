<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Test</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/config.js"></script>
</head>
<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 20px;">
            <div class="back-btn" onclick="location.href='index.html'" style="margin-bottom: 0;">‚Üê Back</div>
            
            <div style="position: relative;">
                <button id="btn-filter-toggle" class="btn-filter">
                    <span>üîç Filter</span>
                </button>
                <div id="filter-dropdown" class="filter-dropdown">
                    <div style="padding: 10px; border-bottom: 1px solid var(--border-color); font-weight: bold; font-size: 0.9rem;">
                        Filter by Name
                        <span style="float: right; cursor: pointer;" onclick="toggleFilterMenu()">‚úñ</span>
                    </div>
                    <div id="filter-options-list" class="filter-list"></div>
                    <button class="btn-clear-filter" onclick="clearFilter()">Show All</button>
                </div>
            </div>
        </div>

        <h2 id="list-title">Select Test</h2>
        
        <div id="test-container" style="width: 100%; display: flex; flex-direction: column; align-items: center;"></div>
        
        <div id="no-result-msg" style="display:none; color: var(--text-secondary); margin-top: 20px;">No matching tests found.</div>
    </div>

    <script>
        // Theme Logic (Keep consistent)
        var savedTheme = localStorage.getItem('site-theme');
        if(savedTheme === 'dark') { document.body.classList.add('dark-mode'); }

        window.onload = function() {
            var params = new URLSearchParams(window.location.search);
            var subject = params.get('subject');
            
            if(!subject || !GITHUB_FILES[subject]) {
                alert("Invalid Subject");
                location.href = 'index.html';
                return;
            }

            document.getElementById('list-title').innerText = subject.toUpperCase().replace('_', ' ');
            var list = document.getElementById('test-container');
            var files = GITHUB_FILES[subject];

            files.forEach(function(f) {
                var div = document.createElement('div');
                div.className = 'test-item';
                
                // NEW: removing a üìÑ icon for a professional look
                div.innerHTML = "<span>" + f.name + "</span>";
                
                var saved = localStorage.getItem(f.file);
                var btn = document.createElement('button');
                
                if (saved) {
                    btn.className = 'btn btn-blue'; 
                    btn.innerText = "Result"; // Shorter text fits better on mobile
                    btn.onclick = function() { location.href = "exam.html?showResult=true&file=" + encodeURIComponent(f.file); };
                } else {
                    btn.className = 'btn btn-green'; 
                    btn.innerText = "Start";
                    btn.onclick = function() { location.href = "instructions.html?file=" + encodeURIComponent(f.file); };
                }
                div.appendChild(btn);
                list.appendChild(div);
            });
        };

        window.onpageshow = function(event) {
            if (event.persisted) { window.location.reload(); }
        };
    </script>
</body>
</html>
