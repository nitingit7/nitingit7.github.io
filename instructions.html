<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructions</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="module">
        import { inject } from 'https://cdn.jsdelivr.net/npm/@vercel/analytics/+esm';
        inject();
    </script>
    <script>
        import { injectSpeedInsights } from 'https://cdn.jsdelivr.net/npm/@vercel/speed-insights/+esm';
        injectSpeedInsights();
    </script>
</head>
<body>

    <div class="inst-container">
        <div class="inst-header">
            <h2 style="margin:0;">General Instructions</h2>
            <p style="color:var(--text-secondary); margin:5px 0 0 0;">Please read the following instructions carefully.</p>
        </div>

        <div class="inst-content">
            <p>1. Total duration of the examination is defined in the timer box.</p>
            <p>2. The clock will be set at the server. The countdown timer in the top right corner of screen will display the remaining time available for you to complete the examination. When the timer reaches zero, the examination will end by itself.</p>
            
            <p>3. The Question Palette displayed on the right side of screen will show the status of each question using one of the following symbols:</p>
            
            <div style="margin: 20px 0; padding: 10px; background: var(--bg-color); border: 1px solid var(--border-color); border-radius: 5px;">
                <div class="legend-row">
                    <div class="legend-icon l-not-visit">1</div>
                    <div>You have not visited the question yet.</div>
                </div>
                <div class="legend-row">
                    <div class="legend-icon l-not-ans">2</div>
                    <div>You have not answered the question.</div>
                </div>
                <div class="legend-row">
                    <div class="legend-icon l-ans">3</div>
                    <div>You have answered the question.</div>
                </div>
                <div class="legend-row">
                    <div class="legend-icon l-mark">4</div>
                    <div>You have NOT answered the question but have marked the question for review.</div>
                </div>
                <div class="legend-row">
                    <div class="legend-icon l-ans-mark">5</div>
                    <div>The question(s) "Answered and Marked for Review" will be considered for evaluation.</div>
                </div>
            </div>

            <h3>Navigating to a Question:</h3>
            <p>4. To answer a question, do the following:</p>
            <ul>
                <li>Click on the question number in the Question Palette to go to that question directly.</li>
                <li>Click on <strong>Save & Next</strong> to save your answer for the current question and then go to the next question.</li>
                <li>Click on <strong>Mark for Review & Next</strong> to save your answer for the current question, mark it for review, and then go to the next question.</li>
            </ul>
        </div>

        <div class="footer-box">
            <label class="chk-label">
                <input type="checkbox" id="consent-chk" class="chk-input" onchange="toggleStartBtn()">
                <span>I have read and understood the instructions. I agree that I am not carrying any prohibited material.</span>
            </label>
            <button id="btn-start-test" class="btn-start" onclick="startExam()">I am ready to begin</button>
        </div>
    </div>

    <script>
        // --- 1. APPLY DARK MODE IF SELECTED ---
        // This checks the memory to see if user selected dark mode previously
        var savedTheme = localStorage.getItem('site-theme');
        if(savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        }

        // --- 2. EXISTING LOGIC ---
        var params = new URLSearchParams(window.location.search);
        var fileUrl = params.get('file');

        function toggleStartBtn() {
            var chk = document.getElementById('consent-chk');
            var btn = document.getElementById('btn-start-test');
            if(chk.checked) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        }

        function startExam() {
            if(!fileUrl) {
                alert("Error: No test file selected.");
                location.href = "index.html";
                return;
            }
            // Redirect to the actual Exam Page
            location.replace("exam.html?file=" + encodeURIComponent(fileUrl));
        }
    </script>

</body>
</html>
