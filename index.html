<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practice King</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="module">
        import { inject } from 'https://cdn.jsdelivr.net/npm/@vercel/analytics/+esm';
        inject();
    </script>
</head>
<body>
    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" onclick="toggleTheme(event)">
            <div class="slider-round"></div>
        </label>
    </div>

    <div class="container">
        <h2>Practice King <span style="font-size:0.5em; vertical-align:super; opacity:0.6;">BETA</span></h2>
        
        <div class="subject-card" onclick="location.href='list.html?subject=quant'">
            <div style="display:flex; align-items:center;">
                <div class="icon">üìä</div> 
                <div>
                    <strong>Quantitative Aptitude</strong>
                </div>
            </div> 
            <span>‚ûú</span>
        </div>
        
        <div class="subject-card" onclick="location.href='list.html?subject=reasoning'">
            <div style="display:flex; align-items:center;">
                <div class="icon">üß©</div> 
                <div>
                    <strong>Reasoning Ability</strong>
                </div>
            </div> 
            <span>‚ûú</span>
        </div>
        
        <div class="subject-card" onclick="location.href='list.html?subject=english'">
            <div style="display:flex; align-items:center;">
                <div class="icon">üìñ</div> 
                <div>
                    <strong>English Language</strong>
                </div>
            </div> 
            <span>‚ûú</span>
        </div>

        <!-- <div class="subject-card" onclick="location.href='list.html?subject=general'">
            <div style="display:flex; align-items:center;">
                <div class="icon">üåç</div> 
                <div>
                    <strong>General Awareness</strong>
                </div>
            </div> 
            <span>‚ûú</span>
        </div> -->

        <div style="margin-top: 50px; text-align: center; color: var(--text-secondary); font-size: 0.9rem; opacity: 0.8;">
            <p>üí° <strong>Tip:</strong> Refresh often for new tests!</p>
        </div>
    </div>

    <script>
        function toggleTheme(event) {
            var chk = document.getElementById('checkbox');
            var isDark = chk.checked; 
            
            // 1. Check if browser supports the animation
            if (!document.startViewTransition) {
                applyTheme(isDark);
                return;
            }

            // 2. Get click coordinates
            var x = event.clientX;
            var y = event.clientY;

            // 3. Calculate radius
            var endRadius = Math.hypot(
                Math.max(x, window.innerWidth - x),
                Math.max(y, window.innerHeight - y)
            );

            // 4. Run the Transition
            var transition = document.startViewTransition(() => {
                applyTheme(isDark);
            });

            // 5. Animate the circle
            transition.ready.then(() => {
                var clipPath = [
                    `circle(0px at ${x}px ${y}px)`,
                    `circle(${endRadius}px at ${x}px ${y}px)`
                ];

                // --- THE CHANGE IS HERE ---
                // We removed the conditional logic. 
                // Now it ALWAYS expands the NEW view (white or dark) on top of the old one.
                document.documentElement.animate(
                    {
                        clipPath: clipPath, 
                    },
                    {
                        duration: 500,
                        easing: 'ease-in',
                        // Always animate the NEW incoming view
                        pseudoElement: '::view-transition-new(root)', 
                    }
                );
            });
        }

        function applyTheme(isDark) {
            if(isDark) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('site-theme', 'dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('site-theme', 'light');
            }
        }

        // Apply Theme on Load
        (function() {
            var savedTheme = localStorage.getItem('site-theme');
            var chk = document.getElementById('checkbox');
            if(savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                if(chk) chk.checked = true; 
            }
        })();
    </script>
</body>
</html>
